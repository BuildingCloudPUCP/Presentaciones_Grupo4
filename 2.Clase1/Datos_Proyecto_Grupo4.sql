create table tb_Pais(
	Cod_Pais int not null constraint pk_tb_Pais primary key (Cod_Pais),
	Nombre_Pais varchar(10) not null
)

go

alter table tb_Pais
ADD CONSTRAINT uq_tb_Pais unique(Nombre_Pais)

go

create table tb_Grupo (
	Cod_Grupo		int not null constraint pk_tb_Grupo primary key (Cod_Grupo),
	Nombre_Grupo	varchar(15) not null
)

go

alter table tb_Grupo
ADD CONSTRAINT uq_tb_Grupo unique(Nombre_Grupo)
go

create table tb_Ausencia(
	Cod_Ausencia int not null constraint pk_Cod_Ausencia primary key (Cod_Ausencia),
	Nombre_Ausencia varchar(20) not null
	)

go
create table tb_Empleados(
	Cod_Empleado	char(6) not null constraint pk_Cod_Empleado primary key (Cod_Empleado),
	Nombre_Empleado varchar(10) not null,
	Cod_Grupo 		int not null foreign key references tb_Grupo(Cod_Grupo),
	Cod_Pais		int not null foreign key references tb_Pais(Cod_Pais)
)

go

create table Fact_Emp_Ausencia(
	Cod_Id 			int primary key identity(1,1),
	Cod_Empleado	char(6) not null foreign key references tb_Empleados(Cod_Empleado),
	Fecha			date not null,
	Cod_Ausencia	int not null foreign key references tb_Ausencia(Cod_Ausencia),
	Minutos			int not null
)

go

insert into tb_Pais
values (1,'Peru'),
(2,'Mexico')

go

insert into tb_Grupo
values (1,'Chat'),
(2,'General Sales'),
(3,'Leadership')

go

insert into tb_Ausencia
values (1,' Personal'),
(2,' Report Late Unp'),
(3,' Sick Paid'),
(4,' Sick Unpaid'),
(5,'Social Sec Sick'),
(6,' Unpaid')


go

insert into tb_Empleados
values ('050620','dro, Elg',2,1),
('050643','ana, Ant',1,1),
('051404','nco, Pre',2,1),
('053230','Ana, Per',1,1),
('079703','uis, Cor',1,1),
('079844','ana, Muñ',1,1),
('083167','ica, Agu',1,1),
('256703','MAR, MAR',2,2),
('261962','OCE, SUE',2,2),
('268305','rid, Bog',1,1),
('269070','MEZ, DRA',2,2),
('272094','Gue, ana',1,2),
('274230','Par, tha',1,2),
('274346','dra, Alf',1,1),
('280020','OZE, UYA',2,2),
('283761','GON, UEL',2,2),
('284645','Gon, eli',3,2),
('287003','MAN, AVO',2,2),
('287004','NOV, DIO',2,2),
('287274','PAC, MAR',2,2),
('289486','MOR, AEL',1,2),
('290825','Var, rio',2,2),
('290828','Ter, uis',2,2),
('290832','Her, car',2,2),
('291478','Cov, tte',1,2),
('296064','ary, Rod',2,1),
('297411','Ave, ria',1,2),
('297674','irk, Hei',2,1),
('298261','Car, ive',1,2),
('299983','nge, Mon',1,1),
('305442','ana, Oli',1,1),
('305464','ica, San',1,1),
('324464','lda, Ara',1,1),
('324465','lyn, Adr',1,1),
('324899','nia, Coe',1,1),
('343164','ile, Arc',1,1),
('367193','ría, Roj',1,1),
('372364','dia, Cha',1,1),
('372372','Ian, Wel',1,1),
('374556','ana, Gar',1,1),
('421484','rco, Sch',3,1),
('471509','ssa, Poi',2,1),
('471530','cia, Sug',3,1),
('520212','que, Mar',3,1),
('555036','Alv, ane',2,2),
('583247','ssa, Sal',1,1),
('586725','ara, Toy',1,1),
('603894','uan, Can',1,1),
('606344','ola, Tue',1,1)

go

insert into tb_Empleados
values ('617389','lla, Roj',1,1),
('617434','nis, Inf',3,1),
('617534','nna, Chi',1,1),
('620882','rmo, Cua',1,1),
('621087','Ram, des',2,2),
('625680','Gon, rdo',3,2),
('625793','ula, Lun',1,1),
('630939','ren, Tam',1,1),
('630940','sco, Val',1,1),
('630977','Zun, Ana',2,2),
('639763','Ram, des',1,2),
('648764','Gom, rdo',2,2),
('649193','Per, eta',1,2),
('649960','Cig, car',2,2),
('652580','ola, Chi',1,1),
('653885','ine, Sar',1,1),
('656520','dro, Rod',2,1),
('656530','rio, Lav',2,1),
('656591','Ver, tha',1,2),
('656645','ren, Sar',1,1),
('663018','ria, Gon',2,1),
('665860','rla, Chi',1,1),
('667929','ena, Cho',3,1),
('671019','ica, Isa',1,1),
('671028','des, Rin',2,1),
('672158','ily, Cha',2,1),
('672221','ose, Ort',2,1),
('676060','De , ara',3,2),
('682854','Ana, Veg',1,1),
('682894','ine, Bue',2,1),
('682906','ena, Mor',3,1),
('689458','Mon, van',3,2),
('693996','Men, ren',1,2),
('709715','Rob, rco',1,2),
('711265','Ana, Rey',2,1),
('711402','rea, Mir',1,1),
('714733','rea, Con',1,1),
('717339','Baz, rge',1,2),
('718176','Cej, ora',1,2),
('718188','Cru, rea',1,2),
('718552','Gue, ena',2,2),
('721784','Pie, uis',1,2),
('738718','Tor, nel',1,2),
('740313','Gar, ana',1,2),
('746979','ara, Per',1,1),
('747429','ura, Cha',2,1),
('748599','Gon, vid',1,2),
('782190','Man, nda',1,2),
('785487','Roj, ela',1,2),
('786989','igo, Ber',2,1),
('790627','Ram, ina',1,2),
('790771','Ana, Peñ',2,1),
('791693','SAN, DRA',1,2),
('793265','Ser, uis',2,2),
('793268','Pac, ana',2,2),
('793677','Her, rea',2,2),
('809354','ose, Del',1,1),
('810895','ZUA, NZA',2,2),
('810899','CRU, RGE',2,2),
('810901','SAN, BEL',2,2),
('814146','ina, Rin',2,1),
('842405','ego, Fuk',2,1),
('842479','RIV, HER',2,2),
('842711','din, Yup',2,1),
('842716','ana, Ber',2,1),
('867163','ika, Ari',2,1),
('867169','cia, Tab',1,1),
('867173','cxa, Mej',2,1),
('867174','rdo, Cas',1,1),
('867190','Bas, ria',1,2)

go

SET IDENTITY_INSERT Fact_Emp_Ausencia ON;
go

insert into Fact_Emp_Ausencia (Cod_Id ,Cod_Empleado,Fecha,Cod_Ausencia,Minutos)
values (1,'583247','2023-1-9',2,2),
(2,'374556','2023-1-14',2,119),
(3,'343164','2023-1-30',3,450),
(4,'299983','2023-1-14',3,450),
(5,'305464','2023-1-6',3,450),
(6,'630939','2023-1-30',3,450),
(7,'343164','2023-1-31',3,450),
(8,'305464','2023-1-5',3,145),
(9,'630939','2023-1-31',3,450),
(10,'617389','2023-1-26',3,230),
(11,'372364','2023-1-23',1,450),
(12,'617534','2023-1-4',1,30),
(13,'625793','2023-1-20',6,109),
(14,'617534','2023-1-4',6,30),
(15,'268305','2023-1-8',4,52),
(16,'809354','2023-1-24',4,450),
(17,'050620','2023-1-20',4,82),
(18,'343164','2023-1-3',5,450),
(19,'343164','2023-1-4',5,450),
(20,'343164','2023-1-2',5,450),
(21,'079844','2023-2-13',3,450),
(22,'343164','2023-2-5',3,450),
(23,'586725','2023-2-23',3,450),
(24,'586725','2023-2-14',3,450),
(25,'324899','2023-2-10',4,70),
(26,'296064','2023-2-24',4,450),
(27,'842711','2023-2-20',4,480),
(28,'790771','2023-2-17',4,450),
(29,'343164','2023-2-25',5,450),
(30,'343164','2023-2-16',5,450),
(31,'343164','2023-2-21',5,450),
(32,'343164','2023-2-26',5,450),
(33,'372364','2023-2-1',6,450),
(34,'656645','2023-2-8',6,24),
(35,'672221','2023-2-6',6,450),
(36,'663018','2023-2-27',6,13),
(37,'079703','2023-2-13',2,24),
(38,'053230','2023-2-5',2,49),
(39,'652580','2023-2-6',1,16),
(40,'050643','2023-2-4',1,50),
(41,'324464','2023-3-26',3,450),
(42,'324465','2023-3-13',3,450),
(43,'606344','2023-3-8',3,230),
(44,'083167','2023-3-8',3,450),
(45,'603894','2023-3-15',4,120),
(46,'603894','2023-3-16',4,450),
(47,'867169','2023-3-16',4,135),
(48,'790771','2023-3-10',4,406),
(49,'586725','2023-3-3',5,450),
(50,'343164','2023-3-21',5,450),
(51,'343164','2023-3-14',5,450),
(52,'343164','2023-3-26',5,450),
(53,'343164','2023-3-19',5,450),
(54,'625793','2023-3-6',6,450),
(55,'053230','2023-3-19',6,15),
(56,'711265','2023-3-15',6,4),
(57,'682894','2023-3-31',6,230),
(58,'079703','2023-3-29',2,5),
(59,'714733','2023-3-30',2,6),
(60,'672158','2023-3-28',1,119),
(61,'324465','2023-4-3',3,450),
(62,'671019','2023-4-14',3,450),
(63,'656645','2023-4-10',3,450),
(64,'324465','2023-4-4',3,450),
(65,'656520','2023-4-1',4,230),
(66,'790771','2023-4-1',4,450),
(67,'790771','2023-4-2',4,450),
(68,'867169','2023-4-28',5,450),
(69,'671028','2023-4-25',5,450),
(70,'671028','2023-4-26',5,450),
(71,'671028','2023-4-27',5,450),
(72,'671028','2023-4-28',5,450),
(73,'682854','2023-4-9',6,133),
(74,'083167','2023-4-5',6,450),
(75,'682854','2023-4-10',6,230),
(76,'665860','2023-4-11',6,210),
(77,'842716','2023-4-10',2,3),
(78,'814146','2023-4-12',2,7),
(79,'297674','2023-4-11',1,2),
(80,'842405','2023-4-17',1,38),
(81,'372364','2023-5-15',2,59),
(82,'656530','2023-5-31',2,23),
(83,'471509','2023-5-2',2,2),
(84,'746979','2023-5-30',2,11),
(85,'711402','2023-5-20',2,39),
(86,'372372','2023-5-16',3,450),
(87,'867174','2023-5-9',3,450),
(88,'305464','2023-5-25',3,450),
(89,'367193','2023-5-13',3,450),
(90,'620882','2023-5-9',3,450),
(91,'343164','2023-5-23',5,450),
(92,'343164','2023-5-14',5,450),
(93,'343164','2023-5-7',5,450),
(94,'620882','2023-5-10',4,450),
(95,'653885','2023-5-23',4,230),
(96,'867173','2023-5-14',4,212),
(97,'667929','2023-5-2',6,60),
(98,'617434','2023-5-15',6,107),
(99,'274346','2023-5-30',6,15),
(100,'471530','2023-5-30',1,26),
(101,'324464','2023-6-12',3,450),
(102,'324464','2023-6-17',3,450),
(103,'305442','2023-6-6',3,450),
(104,'324464','2023-6-8',3,450),
(105,'617389','2023-6-16',4,230),
(106,'630940','2023-6-21',4,450),
(107,'324464','2023-6-18',4,450),
(108,'372364','2023-6-19',4,450),
(109,'343164','2023-6-7',5,450),
(110,'324464','2023-6-23',5,450),
(111,'343164','2023-6-3',5,450),
(112,'367193','2023-6-19',6,38),
(113,'867163','2023-6-9',6,450),
(114,'747429','2023-6-2',6,160),
(115,'051404','2023-6-19',6,450),
(116,'421484','2023-6-5',2,4),
(117,'520212','2023-6-27',2,2),
(118,'682906','2023-6-24',2,56),
(119,'421484','2023-6-12',2,3),
(120,'786989','2023-6-17',1,124),
(121,'274230','2023-1-2',3,480),
(122,'649193','2023-1-4',3,240),
(123,'649193','2023-1-5',3,240),
(124,'274230','2023-1-1',3,480),
(125,'649193','2023-1-3',3,240),
(126,'639763','2023-1-5',4,210),
(127,'740313','2023-1-7',4,480),
(128,'718188','2023-1-24',4,480),
(129,'649960','2023-1-4',4,120),
(130,'290832','2023-1-22',4,480),
(131,'256703','2023-1-28',5,480),
(132,'256703','2023-1-21',5,480),
(133,'256703','2023-1-14',5,480),
(134,'256703','2023-1-7',5,480),
(135,'256703','2023-1-23',5,480),
(136,'693996','2023-1-3',2,30),
(137,'272094','2023-1-25',2,210),
(138,'718188','2023-1-26',2,30),
(139,'717339','2023-1-22',6,480),
(140,'648764','2023-1-26',1,390),
(141,'721784','2023-2-23',3,480),
(142,'272094','2023-2-21',3,480),
(143,'721784','2023-2-22',3,480),
(144,'721784','2023-2-24',3,480),
(145,'740313','2023-2-12',4,420),
(146,'740313','2023-2-19',4,480),
(147,'272094','2023-2-14',4,480),
(148,'256703','2023-2-24',5,480),
(149,'256703','2023-2-17',5,480),
(150,'256703','2023-2-10',5,480),
(151,'256703','2023-2-3',5,480),
(152,'256703','2023-2-26',5,480),
(153,'298261','2023-2-8',2,30),
(154,'718188','2023-2-8',2,30),
(155,'717339','2023-2-5',2,30),
(156,'693996','2023-2-20',6,210),
(157,'718176','2023-2-2',6,60),
(158,'656591','2023-2-17',6,60),
(159,'261962','2023-2-17',1,480),
(160,'810901','2023-2-9',1,210),
(161,'867190','2023-3-22',3,480),
(162,'693996','2023-3-27',3,480),
(163,'693996','2023-3-24',3,480),
(164,'740313','2023-3-27',4,480),
(165,'709715','2023-3-9',4,480),
(166,'287003','2023-3-27',4,150),
(167,'555036','2023-3-6',4,240),
(168,'287274','2023-3-1',4,270),
(169,'256703','2023-3-6',5,480),
(170,'256703','2023-3-30',5,480),
(171,'256703','2023-3-23',5,480),
(172,'256703','2023-3-15',5,480),
(173,'256703','2023-3-8',5,480),
(174,'298261','2023-3-10',2,30),
(175,'621087','2023-3-13',2,30),
(176,'290825','2023-3-29',2,124),
(177,'290828','2023-3-19',2,60),
(178,'810899','2023-3-30',2,30),
(179,'793268','2023-3-25',6,480),
(180,'269070','2023-3-3',1,480),
(181,'630977','2023-4-14',3,480),
(182,'793265','2023-4-29',3,480),
(183,'630977','2023-4-13',3,480),
(184,'625680','2023-4-10',3,480),
(185,'625680','2023-4-12',3,480),
(186,'717339','2023-4-20',4,480),
(187,'793265','2023-4-30',4,480),
(188,'283761','2023-4-15',4,480),
(189,'287004','2023-4-29',4,480),
(190,'842479','2023-4-17',4,480),
(191,'274230','2023-4-18',5,480),
(192,'274230','2023-4-21',5,480),
(193,'274230','2023-4-25',5,480),
(194,'274230','2023-4-27',5,480),
(195,'274230','2023-4-20',5,480),
(196,'274230','2023-4-24',5,480),
(197,'790627','2023-4-30',2,90),
(198,'790627','2023-4-28',2,90),
(199,'290828','2023-4-17',1,30),
(200,'790627','2023-4-30',6,240),
(201,'738718','2023-5-19',3,480),
(202,'738718','2023-5-18',3,480),
(203,'793265','2023-5-3',3,480),
(204,'718188','2023-5-14',4,161),
(205,'842479','2023-5-20',4,480),
(206,'810895','2023-5-3',4,480),
(207,'810895','2023-5-4',4,480),
(208,'256703','2023-5-29',5,480),
(209,'256703','2023-5-22',5,480),
(210,'256703','2023-5-15',5,480),
(211,'256703','2023-5-2',5,480),
(212,'256703','2023-5-31',5,480),
(213,'709715','2023-5-10',2,120),
(214,'290828','2023-5-29',2,60),
(215,'689458','2023-5-31',2,60),
(216,'738718','2023-5-26',6,480),
(217,'280020','2023-5-17',6,210),
(218,'793677','2023-5-7',6,300),
(219,'676060','2023-5-3',1,120),
(220,'284645','2023-5-11',1,420),
(221,'793268','2023-6-21',3,480),
(222,'793268','2023-6-22',3,480),
(223,'718552','2023-6-18',3,480),
(224,'630977','2023-6-13',3,480),
(225,'810901','2023-6-3',3,480),
(226,'721784','2023-6-20',4,480),
(227,'793268','2023-6-20',4,60),
(228,'791693','2023-6-21',4,480),
(229,'748599','2023-6-9',4,90),
(230,'256703','2023-6-7',5,480),
(231,'256703','2023-6-29',5,480),
(232,'256703','2023-6-25',5,480),
(233,'256703','2023-6-18',5,480),
(234,'793268','2023-6-5',2,60),
(235,'291478','2023-6-15',2,30),
(236,'297411','2023-6-15',2,30),
(237,'782190','2023-6-15',2,30),
(238,'785487','2023-6-15',2,30),
(239,'639763','2023-6-16',6,90),
(240,'289486','2023-6-29',1,480)


